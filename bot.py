import telebot
import shared
from log_reg import logistik_reg

TOKEN = '8072667336:AAHBqIJEi_ePYE6EsrbQEVl3Rtpf2_5txXQ'

bot = telebot.TeleBot(TOKEN)

@bot.message_handler(commands=['start'])
def start_message(message):
    bot.send_message(message.chat.id,
        "üëã –ü—Ä–∏–≤–µ—Ç!\n\n"
        "–Ø ‚Äî –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞–ª–∏—á–∏—è —Ä–∞–∫–∞ –≥—Ä—É–¥–∏ ü©∫\n"
        "–î–ª—è —ç—Ç–æ–≥–æ –º–Ω–µ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è *30 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–ø—É—Ö–æ–ª–∏*.\n\n"
        "üìä –í–æ—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–≤–µ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:\n\n"
        "üîπ *radius (mean)* ‚Äî —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–¥–∏—É—Å –æ–ø—É—Ö–æ–ª–∏\n"
        "üîπ *texture (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è —Ç–µ–∫—Å—Ç—É—Ä–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏\n"
        "üîπ *perimeter (mean)* ‚Äî —Å—Ä–µ–¥–Ω–∏–π –ø–µ—Ä–∏–º–µ—Ç—Ä –æ–ø—É—Ö–æ–ª–∏\n"
        "üîπ *area (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è –ø–ª–æ—â–∞–¥—å –æ–ø—É—Ö–æ–ª–∏\n"
        "üîπ *smoothness (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è –≥–ª–∞–¥–∫–æ—Å—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏\n"
        "üîπ *compactness (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç—å –æ–ø—É—Ö–æ–ª–∏\n"
        "üîπ *concavity (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è –≤–æ–≥–Ω—É—Ç–æ—Å—Ç—å –∫–æ–Ω—Ç—É—Ä–∞\n"
        "üîπ *concave points (mean)* ‚Äî —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –≤–æ–≥–Ω—É—Ç—ã—Ö —Ç–æ—á–µ–∫\n"
        "üîπ *symmetry (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è —Å–∏–º–º–µ—Ç—Ä–∏—è\n"
        "üîπ *fractal dimension (mean)* ‚Äî —Å—Ä–µ–¥–Ω—è—è —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å\n\n"
        "üî∏ *radius (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Ä–∞–¥–∏—É—Å–∞\n"
        "üî∏ *texture (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã\n"
        "üî∏ *perimeter (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –ø–µ—Ä–∏–º–µ—Ç—Ä–∞\n"
        "üî∏ *area (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –ø–ª–æ—â–∞–¥–∏\n"
        "üî∏ *smoothness (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≥–ª–∞–¥–∫–æ—Å—Ç–∏\n"
        "üî∏ *compactness (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏\n"
        "üî∏ *concavity (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–æ–≥–Ω—É—Ç–æ—Å—Ç–∏\n"
        "üî∏ *concave points (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–æ–≥–Ω—É—Ç—ã—Ö —Ç–æ—á–µ–∫\n"
        "üî∏ *symmetry (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Å–∏–º–º–µ—Ç—Ä–∏–∏\n"
        "üî∏ *fractal dimension (se)* ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏\n\n"
        "üî∫ *radius (worst)* ‚Äî —Ö—É–¥—à–∏–π (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π) —Ä–∞–¥–∏—É—Å\n"
        "üî∫ *texture (worst)* ‚Äî —Ö—É–¥—à–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞\n"
        "üî∫ *perimeter (worst)* ‚Äî —Ö—É–¥—à–∏–π –ø–µ—Ä–∏–º–µ—Ç—Ä\n"
        "üî∫ *area (worst)* ‚Äî —Ö—É–¥—à–∞—è –ø–ª–æ—â–∞–¥—å\n"
        "üî∫ *smoothness (worst)* ‚Äî —Ö—É–¥—à–∞—è –≥–ª–∞–¥–∫–æ—Å—Ç—å\n"
        "üî∫ *compactness (worst)* ‚Äî —Ö—É–¥—à–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç—å\n"
        "üî∫ *concavity (worst)* ‚Äî —Ö—É–¥—à–∞—è –≤–æ–≥–Ω—É—Ç–æ—Å—Ç—å\n"
        "üî∫ *concave points (worst)* ‚Äî —Ö—É–¥—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–≥–Ω—É—Ç—ã—Ö —Ç–æ—á–µ–∫\n"
        "üî∫ *symmetry (worst)* ‚Äî —Ö—É–¥—à–∞—è —Å–∏–º–º–µ—Ç—Ä–∏—è\n"
        "üî∫ *fractal dimension (worst)* ‚Äî —Ö—É–¥—à–∞—è —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å\n\n"
        "üì• –û—Ç–ø—Ä–∞–≤—å –∫–æ–º–∞–Ω–¥—É /predict –∏ –≤–≤–µ–¥–∏ –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:\n"
        "`–ø—Ä–∏–º–µ—Ä: 14.2, 20.3, 90.1, ..., 0.06`\n\n"
        "–Ø –≤—Å—ë –æ–±—Ä–∞–±–æ—Ç–∞—é –∏ —Å–∫–∞–∂—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç üì°",
        parse_mode='Markdown'
    )

@bot.message_handler(commands=['predict'])
def predict_bot(message):
    bot.send_message(message.chat.id, '‚úçÔ∏è –í–≤–µ–¥–∏—Ç–µ 30 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–ø—É—Ö–æ–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:')
    bot.register_next_step_handler(message, data_for_log_reg)
    
def data_for_log_reg(message):
    numbers = message.text.split(',')
    
    if len(numbers) != 30:
        bot.send_message(message.chat.id, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞ –∫–æ–º–∞–Ω–¥—É –∏ –≤–≤–µ–¥–∏—Ç–µ 30 –∑–Ω–∞—á–µ–Ω–∏–π')
        return
    
    shared.data = [float(num.strip()) for num in numbers]
    
    result = logistik_reg(shared.data)[0]
    
    if result == 0:
        bot.send_message(message.chat.id,"üî¥–£ –≤–∞—Å –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ–ø—É—Ö–æ–ª—å")
    else:
        bot.send_message(message.chat.id, "üü¢–£ –≤–∞—Å –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ–ø—É—Ö–æ–ª—å")


bot.infinity_polling()